pipelle:
  description: Pipelle
  cost: c_pipelle_tvu # We assume pipelle and tvu are done together
  sensitivity: .p_pipelle_insertion_success___lynch
  specificity: .p_pipelle_insertion_failure___lynch
  probs: p_pipelle_insertion_success, _
  suffix: lynch
  children:
    - pipelle_tissue:
        in_transition: success
        description: Pipelle tissue
        sensitivity: .p_pipelle_tissue_success
        specificity: .p_pipelle_tissue_failure
        probs: p_pipelle_tissue_success, _
        children:
            - pipelle_result:
                in_transition: success
                description: Pipelle result
                sensitivity: .sensitivity_pipelle___lynch
                specificity: .specificity_pipelle___lynch
                probs: p_pipelle_p, _
                children:
                    # Pipelle +
                    - hysterectomy:
                        in_transition: positive
                        description: Hysterectomy
                        include: '_lynch_hysterectomy.yaml'
                        suffix: pipelle_p
                    - tvu:
                        in_transition: negative
                        description: TVU
                        cost: 0 # Cost already added (see parent node)
                        sensitivity: .sensitivity_tvu___lynch
                        specificity: .specificity_tvu___lynch
                        probs: p_endo_thick, _
                        suffix: pipelle_n
                        children:
                            # Pipelle- & TVU+
                            - hysteroscopy:
                                in_transition: thick endometrium
                                description: Hysteroscopy
                                include: '_lynch_hysteroscopy_evaluation.yaml'
                                suffix: endo_thick
                            # Pipelle- & TVU-
                            - molecular_test_pipelle:
                                in_transition: thin endometrium
                                description: Molecular test (pipelle sample)
                                cost: c_molecular_test_pipelle_visit
                                sensitivity: .sensitivity_molecular_pipelle
                                specificity: .specificity_molecular_pipelle
                                probs: p_molecular_pipelle_p, _
                                suffix: endo_thin
                                children:
                                    - hysteroscopy:
                                        in_transition: positive
                                        description: Hysteroscopy
                                        include: '_lynch_hysteroscopy_evaluation.yaml'
                                        suffix: molecular_pipelle_p
                                    - evaluation:
                                        in_transition: negative
                                        cost: c_phone_visit
                                        include: '_evaluation.yaml'
                                        suffix: molecular_pipelle_n
            # Pipelle tissue failure
            - tvu:
                in_transition: failure
                description: TVU
                cost: 0 # Cost already added (see parent node)
                sensitivity: .sensitivity_tvu___lynch
                specificity: .specificity_tvu___lynch
                probs: p_endo_thick, _
                suffix: pipelle_n
                children:
                    # Pipelle tissue failure & TVU+
                    - molecular_test_pipelle:
                        in_transition: thick endometrium
                        description: Molecular test (pipelle sample)
                        cost: c_molecular_test_pipelle_visit
                        sensitivity: .sensitivity_molecular_pipelle
                        specificity: .specificity_molecular_pipelle
                        probs: p_molecular_pipelle_p, _
                        suffix: endo_thick
                        children:
                            - hysterectomy:
                                in_transition: positive
                                description: Hysterectomy
                                include: '_lynch_hysterectomy.yaml'
                                suffix: molecular_pipelle_p
                            - hysteroscopy:
                                in_transition: negative
                                description: Hysteroscopy
                                include: '_lynch_hysteroscopy_evaluation.yaml'
                                suffix: molecular_pipelle_n
                    # Pipelle tissue failure & TVU-
                    - molecular_test_pipelle:
                        in_transition: thin endometrium
                        description: Molecular test (pipelle sample)
                        cost: c_molecular_test_pipelle_visit
                        sensitivity: .sensitivity_molecular_pipelle
                        specificity: .specificity_molecular_pipelle
                        probs: p_molecular_pipelle_p, _
                        suffix: endo_thin
                        children:
                            - hysteroscopy:
                                in_transition: positive
                                description: Hysteroscopy
                                include: '_lynch_hysteroscopy_evaluation.yaml'
                                suffix: molecular_pipelle_p
                            - evaluation:
                                in_transition: negative
                                cost: c_phone_visit
                                include: '_evaluation.yaml'
                                suffix: molecular_pipelle_n
    # Pipelle insertion failure
    - tvu:
        in_transition: failure
        description: TVU
        cost: 0 # Cost already added (see parent node)
        sensitivity: .sensitivity_tvu___lynch
        specificity: .specificity_tvu___lynch
        probs: p_endo_thick, _
        suffix: pipelle_tissue_f
        children:
            # Pipelle insertion failure & TVU+
            - hysteroscopy:
                in_transition: thick endometrium
                description: Hysteroscopy
                include: '_lynch_hysteroscopy_evaluation.yaml'
                suffix: endo_thick
            # Pipelle insertion failure & TVU-
            - molecular_test_cyto:
                in_transition: thin endometrium
                description: Molecular test (cyto sample)
                cost: c_molecular_test_cyto_visit
                sensitivity: .sensitivity_molecular_cyto
                specificity: .specificity_molecular_cyto
                probs: p_molecular_cyto_p, _
                suffix: endo_thin
                children:
                    - hysteroscopy:
                        in_transition: positive
                        description: Hysteroscopy
                        include: '_lynch_hysteroscopy_evaluation.yaml'
                        suffix: molecular_cyto_p
                    - evaluation:
                        in_transition: negative
                        cost: c_phone_visit
                        include: '_evaluation.yaml'
                        suffix: molecular_cyto_n
